<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="login.css" />
<link rel="stylesheet" href="dropmenu.css" />
<script src="./js/bikes.js"></script>
    <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- jQuery -->
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>  
  <title>Your Cart</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- jQuery -->
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <style>
    .highlight {
      background-color: #e0f3ff !important;
    }
    .selected {
      border: 2px solid #198754;
    }
    .park-logo {
      width: 40px;
      height: 40px;
      object-fit: contain;
      margin-right: 8px;
      vertical-align: middle;
    }
  
#userGreeting
{
  display: flex;
  justify-content: center;     /* horizontal centering */
  align-items: center;         /* vertical centering */
  color: white;
  text-align: center;
}
#banner
{
background-color: lightgrey;
height: 60px;
vertical-align: middle;
width: 100%;
display: flex;
justify-content: center;     /* horizontal centering */
align-items: center;         /* vertical centering */
}
  
#cancelBtn
{
width: 400px;
}

</style>
  </style>
</head>
  

<body onload="checkpll(); checkUserStatus(); displayProfilePicture();">
    <!-- Navigation Bar -->
    <div class="navbar">
      <div class="nav-left">
            <div class="dropdown">
                  <button class="jsmenu"><img src="./images/jsmenu4.png"></button> 
                  <div class="dropdown-content">
                  <a href="index.html">Site Home</a>
                  <a href="cartreview.html">MyCart</a>
                  <a href="parks5.html">Review Park Options</a>
                  <a href="parksreview5.html">Park Reviews</a>
                  <a href="mybookings5.html">MyReservations</a>
                  <a href="manager.html">Manager Utilities</a>
            </div>
    </div> 
      <div class="logo">&nbsp&nbsp&nbsp<H5>MyLinkv25</H5></div>
      </div>
      <div class="nav-right">
        <img src="./images/bluecircle.png" id="profilephototarget" alt="User" style="cursor:pointer;" onclick="window.location.href='profile.html'" />
        <span id="H3UserBanner"></span>
        <a href="login.html" id="loginBtn" class="btn secondary-btn" onclick="loginUser(event)">Login</a>
        <a href="login.html" id="logoutBtn" class="btn secondary-btn" onclick="logoutUser(event)">Logout</a>
                <a href="cartreview.html" id="cartBtn3"><img src="./images/cart4.png" width="40px" height="40px"></a>
      </div>
    </div>
  <div align="center" id="banner"><span id="userGreeting">Welcome Guest</span></div>
  <h4 class="mb-3">Cart Summary Details</h4>
  <div id="cart-summary-container"></div>

  <script>
    async function loadCartData() {
      try {
        const response = await fetch('https://parksapi.547bikes.info/api/Cart');
        const carts = await response.json();

        const container = document.getElementById('cart-summary-container');
        container.innerHTML = '';

        if (!Array.isArray(carts) || carts.length === 0) {
          container.innerHTML = `<div class="alert alert-info">No cart data available.</div>`;
          return;
        }

        carts.forEach(cart => {
          const div = document.createElement('div');
          div.className = 'card mb-3';
          div.innerHTML = `
            <div class="card-body">
              <div><span class="label">Cart ID:</span> ${cart.cartId}</div>
              <div><span class="label">User ID:</span> ${cart.uid}</div>
              <div><span class="label">Park:</span> ${cart.parkname} (ID: ${cart.parkId})</div>
              <div><span class="label">Item:</span> ${cart.itemType} - ${cart.itemDescription}</div>
              <div><span class="label">Quantity:</span> ${cart.quantity}</div>
              <div><span class="label">Unit Price:</span> $${cart.unitPrice.toFixed(2)}</div>
              <div><span class="label">Total Price:</span> $${cart.totalPrice.toFixed(2)}</div>
              <div><span class="label">Reservation:</span> ${cart.resStart?.split('T')[0]} to ${cart.resEnd?.split('T')[0]}</div>
              <div><span class="label">Guests:</span> Adults: ${cart.adults}, Children: ${cart.children}, Tent Sites: ${cart.tentsites}</div>
              <div><span class="label">Booking Info:</span> ${cart.bookinginfo}</div>
              <div><span class="label">Transaction Total:</span> $${cart.transactiontotal.toFixed(2)}</div>
              <div><span class="label">John's Totals:</span> $${cart.johnstotals.toFixed(2)}</div>
              <div><span class="label">Total Cart Items:</span> ${cart.totalcartitems}</div>
              <div><span class="label">Multiple Items:</span> ${cart.multipleitems}</div>
              <div><span class="label">Checked Out:</span> ${cart.isCheckedOut ? 'Yes' : 'No'}</div>
              <div><span class="label">Payment ID:</span> ${cart.paymentid}</div>
              <div><span class="label">Date Added:</span> ${cart.dateAdded}</div>
            </div>
          `;
          container.appendChild(div);
        });
      } catch (error) {
        document.getElementById('cart-summary-container').innerHTML = `
          <div class="alert alert-danger">Failed to load cart data.</div>
        `;
        console.error('Error loading cart data:', error);
      }
    }

    loadCartData();
  </script>
</body>
</html>
